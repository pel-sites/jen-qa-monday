<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QA Step Indicator - Interactive Progress</title>
    <style>
        :root {
            --purple: #9d50dd;
            --green: #00c875;
            --orange: #fdab3d;
            --red: #df2f4a;
            --blue: #579bfc;
            --dark-bg: #1a1a2e;
            --card-bg: #16213e;
            --darker-bg: #0f0f23;
        }

        * { box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--dark-bg) 0%, var(--card-bg) 100%);
            color: #eee;
            min-height: 100vh;
            margin: 0;
            padding: 40px 20px;
        }

        h1 { text-align: center; margin-bottom: 10px; }
        .subtitle { text-align: center; opacity: 0.7; margin-bottom: 40px; }

        /* Step Indicator Container */
        .step-indicator {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px;
            background: var(--card-bg);
            border-radius: 16px;
            border: 1px solid #2a2a4a;
        }

        /* Phase Headers */
        .phase-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .phase-label {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            opacity: 0.5;
            transition: all 0.3s ease;
        }

        .phase-label.active {
            opacity: 1;
            transform: scale(1.05);
        }

        .phase-label.prep { background: var(--blue); }
        .phase-label.prerun { background: var(--orange); color: #000; }
        .phase-label.inprocess { background: var(--green); color: #000; }
        .phase-label.final { background: var(--purple); }

        /* Progress Bar */
        .progress-container {
            position: relative;
            margin: 30px 0;
        }

        .progress-track {
            height: 8px;
            background: var(--darker-bg);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--blue), var(--orange), var(--green), var(--purple));
            background-size: 400% 100%;
            border-radius: 4px;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            animation: shimmer 3s ease infinite;
        }

        @keyframes shimmer {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-size: 0.9em;
            opacity: 0.8;
        }

        /* Steps Grid */
        .steps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 12px;
            margin-top: 30px;
        }

        .step {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .step:hover {
            transform: translateY(-3px);
        }

        .step-circle {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1em;
            border: 3px solid #3a3a5a;
            background: var(--darker-bg);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .step-circle::before {
            content: '';
            position: absolute;
            inset: 0;
            background: currentColor;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        /* Phase colors for circles */
        .step.prep .step-circle { border-color: var(--blue); color: var(--blue); }
        .step.prerun .step-circle { border-color: var(--orange); color: var(--orange); }
        .step.inprocess .step-circle { border-color: var(--green); color: var(--green); }
        .step.final .step-circle { border-color: var(--purple); color: var(--purple); }

        /* Current step - pulsing */
        .step.current .step-circle {
            animation: pulse 2s ease-in-out infinite;
            box-shadow: 0 0 20px currentColor;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.08); }
        }

        /* Completed step */
        .step.completed .step-circle {
            background: currentColor;
            border-color: currentColor;
        }

        .step.completed .step-circle .step-number {
            display: none;
        }

        .step.completed .step-circle::after {
            content: 'âœ“';
            color: #fff;
            font-size: 1.4em;
            font-weight: bold;
        }

        /* Completing animation */
        .step.completing .step-circle {
            animation: complete 0.5s ease forwards;
        }

        @keyframes complete {
            0% { transform: scale(1); }
            30% { transform: scale(1.3); }
            60% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }

        .step-name {
            font-size: 0.7em;
            margin-top: 8px;
            text-align: center;
            opacity: 0.7;
            transition: opacity 0.2s ease;
            max-width: 90px;
            line-height: 1.3;
        }

        .step:hover .step-name,
        .step.current .step-name {
            opacity: 1;
        }

        /* Controls */
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .btn-primary {
            background: var(--green);
            color: #000;
        }

        .btn-primary:hover {
            background: #00d885;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 200, 117, 0.4);
        }

        .btn-secondary {
            background: var(--darker-bg);
            color: #eee;
            border: 1px solid #3a3a5a;
        }

        .btn-secondary:hover {
            background: #1a1a3a;
        }

        .btn-reset {
            background: var(--red);
            color: #fff;
        }

        .btn-reset:hover {
            background: #ff3355;
        }

        /* Step Detail Panel */
        .step-detail {
            margin-top: 30px;
            padding: 20px;
            background: var(--darker-bg);
            border-radius: 12px;
            border-left: 4px solid var(--purple);
            display: none;
        }

        .step-detail.visible {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .step-detail h3 {
            margin: 0 0 10px 0;
            color: var(--purple);
        }

        .step-detail p {
            margin: 0;
            opacity: 0.8;
            line-height: 1.6;
        }

        /* Celebration */
        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--card-bg);
            padding: 40px 60px;
            border-radius: 20px;
            text-align: center;
            z-index: 100;
            display: none;
            border: 2px solid var(--green);
            box-shadow: 0 0 60px rgba(0, 200, 117, 0.3);
        }

        .celebration.visible {
            display: block;
            animation: celebrateIn 0.5s ease;
        }

        @keyframes celebrateIn {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .celebration h2 {
            color: var(--green);
            margin: 0 0 15px 0;
            font-size: 2em;
        }

        .celebration .emoji {
            font-size: 4em;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>QA Procedure Progress</h1>
    <p class="subtitle">Click steps to mark complete or use the buttons below</p>

    <div class="step-indicator">
        <!-- Phase Labels -->
        <div class="phase-header">
            <span class="phase-label prep active" data-phase="prep">PREP (Step 0)</span>
            <span class="phase-label prerun" data-phase="prerun">PRE-RUN (Steps 1-6)</span>
            <span class="phase-label inprocess" data-phase="inprocess">IN-PROCESS (Steps 7-11)</span>
            <span class="phase-label final" data-phase="final">FINAL (Steps 12-13)</span>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-track">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text">
                <span id="completedCount">0</span> of 14 steps completed
            </div>
        </div>

        <!-- Steps Grid -->
        <div class="steps-grid" id="stepsGrid">
            <!-- Steps will be generated by JS -->
        </div>

        <!-- Controls -->
        <div class="controls">
            <button class="btn btn-primary" id="nextBtn">Complete Current Step</button>
            <button class="btn btn-secondary" id="prevBtn">Undo Last</button>
            <button class="btn btn-reset" id="resetBtn">Reset All</button>
        </div>

        <!-- Step Detail Panel -->
        <div class="step-detail" id="stepDetail">
            <h3 id="detailTitle">Step 0: What I Open First</h3>
            <p id="detailDesc">Open Monday.com, locate today's run in Sprint/Bulk weekly sheet, gather spec sheet and QA Inspection Report template.</p>
        </div>
    </div>

    <!-- Celebration Modal -->
    <div class="celebration" id="celebration">
        <div class="emoji">ðŸŽ‰</div>
        <h2>QA Complete!</h2>
        <p>All 14 steps finished. Great job!</p>
        <button class="btn btn-primary" onclick="resetAll()" style="margin-top: 20px;">Start New Run</button>
    </div>

    <script>
        const steps = [
            { id: 0, name: 'Open First', phase: 'prep', desc: 'Open Monday.com, locate today\'s run in Sprint/Bulk weekly sheet, gather spec sheet and QA Inspection Report template.' },
            { id: 1, name: 'Spec Sheet', phase: 'prerun', desc: 'Ensure spec sheet is physically at the production line before any work begins.' },
            { id: 2, name: 'Components', phase: 'prerun', desc: 'Verify all components match the spec sheet and batch record requirements.' },
            { id: 3, name: 'Batch Code', phase: 'prerun', desc: 'Set up batch code, verify label printer is loaded and calibrated.' },
            { id: 4, name: 'Equipment', phase: 'prerun', desc: 'Check all equipment calibration - scales, thermometers, measuring devices.' },
            { id: 5, name: 'Line Config', phase: 'prerun', desc: 'Verify line configuration and complete sanitation check.' },
            { id: 6, name: 'MO Verify', phase: 'prerun', desc: 'Match Manufacturing Order with batch record and spec sheet. No run starts until all match.' },
            { id: 7, name: 'Begin QA Doc', phase: 'inprocess', desc: 'Start QA Inspection Report - header info, date, batch code, product name.' },
            { id: 8, name: 'In-Process', phase: 'inprocess', desc: 'Perform in-process checks: weights, fills, appearance, temperature as applicable.' },
            { id: 9, name: 'Defects', phase: 'inprocess', desc: 'Classify any defects found - Critical, Major, or Minor. Document with photos.' },
            { id: 10, name: 'Standards', phase: 'inprocess', desc: 'Compare finished product to retention sample. Check for visual/sensory standards.' },
            { id: 11, name: 'Close-out', phase: 'inprocess', desc: 'Complete end-of-run tasks: final counts, yield calculations, sign-offs.' },
            { id: 12, name: 'Save Docs', phase: 'final', desc: 'Save completed QA Inspection Report to Google Drive in proper folder structure.' },
            { id: 13, name: 'Monday.com', phase: 'final', desc: 'Attach QA docs to the Monday.com ticket in QA DOCS column. Mark complete.' }
        ];

        let completedSteps = new Set();
        let currentStep = 0;

        function init() {
            renderSteps();
            updateProgress();
            updatePhaseLabels();
            showStepDetail(currentStep);
        }

        function renderSteps() {
            const grid = document.getElementById('stepsGrid');
            grid.innerHTML = steps.map(step => `
                <div class="step ${step.phase} ${step.id === currentStep ? 'current' : ''}"
                     data-step="${step.id}"
                     onclick="toggleStep(${step.id})">
                    <div class="step-circle">
                        <span class="step-number">${step.id}</span>
                    </div>
                    <span class="step-name">${step.name}</span>
                </div>
            `).join('');
        }

        function toggleStep(stepId) {
            const stepEl = document.querySelector(`[data-step="${stepId}"]`);

            if (completedSteps.has(stepId)) {
                // Uncomplete
                completedSteps.delete(stepId);
                stepEl.classList.remove('completed');
            } else {
                // Complete with animation
                stepEl.classList.add('completing');
                setTimeout(() => {
                    stepEl.classList.remove('completing');
                    stepEl.classList.add('completed');
                    completedSteps.add(stepId);
                    updateProgress();
                    updatePhaseLabels();

                    // Move to next uncompleted step
                    const nextUncompleted = steps.find(s => !completedSteps.has(s.id));
                    if (nextUncompleted) {
                        setCurrentStep(nextUncompleted.id);
                    }

                    // Check for completion
                    if (completedSteps.size === steps.length) {
                        showCelebration();
                    }
                }, 300);
                return;
            }

            updateProgress();
            updatePhaseLabels();
            showStepDetail(stepId);
        }

        function setCurrentStep(stepId) {
            currentStep = stepId;
            document.querySelectorAll('.step').forEach(el => {
                el.classList.remove('current');
                if (parseInt(el.dataset.step) === stepId) {
                    el.classList.add('current');
                }
            });
            showStepDetail(stepId);
        }

        function updateProgress() {
            const percent = (completedSteps.size / steps.length) * 100;
            document.getElementById('progressFill').style.width = `${percent}%`;
            document.getElementById('completedCount').textContent = completedSteps.size;
        }

        function updatePhaseLabels() {
            const phases = ['prep', 'prerun', 'inprocess', 'final'];
            const currentPhase = steps[currentStep]?.phase || 'prep';

            document.querySelectorAll('.phase-label').forEach(label => {
                const phase = label.dataset.phase;
                const phaseSteps = steps.filter(s => s.phase === phase);
                const phaseCompleted = phaseSteps.every(s => completedSteps.has(s.id));
                const phaseCurrent = phase === currentPhase;

                label.classList.toggle('active', phaseCurrent || phaseCompleted);
            });
        }

        function showStepDetail(stepId) {
            const step = steps.find(s => s.id === stepId);
            if (!step) return;

            const detail = document.getElementById('stepDetail');
            document.getElementById('detailTitle').textContent = `Step ${step.id}: ${step.name}`;
            document.getElementById('detailDesc').textContent = step.desc;

            // Update border color based on phase
            const colors = { prep: '#579bfc', prerun: '#fdab3d', inprocess: '#00c875', final: '#9d50dd' };
            detail.style.borderLeftColor = colors[step.phase];
            document.getElementById('detailTitle').style.color = colors[step.phase];

            detail.classList.add('visible');
        }

        function completeCurrentStep() {
            if (!completedSteps.has(currentStep)) {
                toggleStep(currentStep);
            } else {
                // Find next uncompleted
                const nextUncompleted = steps.find(s => !completedSteps.has(s.id));
                if (nextUncompleted) {
                    setCurrentStep(nextUncompleted.id);
                    toggleStep(nextUncompleted.id);
                }
            }
        }

        function undoLast() {
            if (completedSteps.size === 0) return;

            // Find the highest completed step
            const lastCompleted = Math.max(...completedSteps);
            completedSteps.delete(lastCompleted);

            document.querySelector(`[data-step="${lastCompleted}"]`).classList.remove('completed');
            setCurrentStep(lastCompleted);
            updateProgress();
            updatePhaseLabels();

            // Hide celebration if showing
            document.getElementById('celebration').classList.remove('visible');
        }

        function resetAll() {
            completedSteps.clear();
            document.querySelectorAll('.step').forEach(el => el.classList.remove('completed'));
            setCurrentStep(0);
            updateProgress();
            updatePhaseLabels();
            document.getElementById('celebration').classList.remove('visible');
        }

        function showCelebration() {
            document.getElementById('celebration').classList.add('visible');
        }

        // Button handlers
        document.getElementById('nextBtn').addEventListener('click', completeCurrentStep);
        document.getElementById('prevBtn').addEventListener('click', undoLast);
        document.getElementById('resetBtn').addEventListener('click', resetAll);

        // Initialize
        init();
    </script>
</body>
</html>
